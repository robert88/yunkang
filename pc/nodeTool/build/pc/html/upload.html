<style>@charset "UTF-8"; </style>
<div class="block" id="J-upload-wrap"> <h2>upload user's image</h2>  <div class="popup-box popup-upload" style="top:80px;"> <div class="hd"> <h3 class="hd-tit"><b>Your Profile Photo</b></h3> <a class="close dl-close" title="close"><i class="i-font i-close">X</i></a> </div> <div class="bd"> <div class="upload-box"> <div class="select-file"> <div class="select-area J-select-area"> <a class="btn btn-upload J-btn-upload" > <i class="i-font i-camera">N</i> <span>Upload Photo</span> </a> <label style="display: block;position:absolute;width: 100%;height: 100%;left: 0px;top: 0px"><input type="file" class="J-input-file"></label> <input type="hidden" class="J-upload-file-path"> <input id="loginPicField" type="hidden" name="userimg" check-type="required"> </div> <a class="btn btn-delete J-btn-delete" style="display: none;">delete</a> <div class="control-bar"> <a class="btn btn-reduce J-reduce" style="display: none"><i class="i-font">h</i></a> <a class="btn btn-zoom J-zoom" style="display: none"><i class="i-font">i</i></a> </div> <div class="desc"> <p>Format: PNG or JPG (Min 5 mb)</p> <p class="ls-f-dark">Snap or choose an amazing photo of yourself.</p> </div> </div> </div> <p> <a class="btn btn-m btn-primary J-upload-submit" >Save</a> <a class="btn btn-m btn-cancel dl-close">Cancel</a> </p> </div>  </div>
<script>;(function(){ var innerModule = {};var innerRequire = function(index){ return innerModule[index]; }; /*../../pc/public/js/module/selectFile.js*/(function(){(function(){function e(e,t){var n,r,i;e.dataTransfer?n=e.dataTransfer.files:n=e.target.files,console.log("files",n);for(var s=0;i=n[s];s++)console.log(URL.createObjectURL(i)),r=new FileReader,console.log("name:",i.name,"type:",i.type,"size:",i.size,"lastmodify",i.lastModifiedDate,"webkitRelativePath",i.webkitRelativePath),r.onload=function(e){return function(n){var r=n.srcElement.result;typeof t=="function"&&t(r,e)}}(i),r.readAsDataURL(i)}function t(t,n){t.stopPropagation(),t.preventDefault(),document.domain&&e(t,n)}function n(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}function r(e,t){i(e,t)}function i(e,r){e[0].tagName==="INPUT"?e.on("change",function(e){console.log("dfjdskfj"),t(e,r)}):(e.on("drop",function(e){t(e,r)}),e.on("dragover",n,r))}if($.fn.selectFile){console.log("$.fn.selectFile has init!");return}$.fn.selectFile=function(e){return this.each(function(){var t=$(this);$.fn.fileReader?t.fileReader({callback:function(){r(t,e)},load:e}):r(t,e)})}})()})();/*../../pc/public/js/module/cutImage.js*/(function(){var e={width:500,height:500,left:0,top:0,zoom:1,conver:!1,type:"image/jpeg"};$.cutImage&&console.log("$.cutImage has init!"),$.cutImage=function(t){var n=$.extend({},e,t),r=Math.round(n.width),i=Math.round(n.height),s=n.zoom,o=Math.round(n.left)*s,u=Math.round(n.top)*s,a=n.conver,f=n.img,l=n.type,c;f||console.error("img not find!");var h=$("#cvs");h.length||($("body").append("<canvas style='display:none' id='cvs' width="+r+" height="+i+"></canvas>"),h=$("#cvs"));var p=h[0].getContext("2d");return h[0].width=r,h[0].height=i,p.drawImage(f,o,u,r*s,i*s,0,0,r,i),c=h[0].toDataURL(l),a&&c.replace(l,"image/octet-stream"),c}})();/*../../pc/html/upload.js*/(function(){$(function(){function x(){var e=y-6,n=b-6*b/y;if(e<l+1||n<c+1)return!1;b=n,y=e,t.css({backgroundSize:"{0}px {1}px".tpl(y,b)})}function T(){var e=y+6,n=b+6*b/y;b=n,y=e,t.css({backgroundSize:"{0}px {1}px".tpl(y,b)})}function N(){var e=-t.css("background-position-y").toFloat()/h,n=-t.css("background-position-x").toFloat()/h;console.log("cut",e,n);if(S.load){var r=$.cutImage({img:S,width:c,height:c,top:e,left:n,type:S.type,zoom:E/b});return r}return $.tips("Image file is loadding!"),!1}innerRequire(2),innerRequire(1);var e=$("#J-upload-wrap"),t=e.find(".J-select-area"),n=e.find(".J-btn-upload"),r=e.find(".J-btn-delete"),i=e.find(".J-input-file"),s=e.find(".J-input-file").parent(),o=e.find(".J-upload-file-path"),u=e.find(".J-reduce"),a=e.find(".J-zoom"),f=e.find(".J-upload-tip"),l=t.data("width")||336,c=t.data("height")||336,h=l/c,p,d,v,m,g,y,b,w,E,S;r.click(function(){n.show(),i.show(),r.hide(),s.show(),t.css({backgroundImage:""}),S=null,i.val("").trigger("change")}),i.selectFile(function(e,u){if(u.type!=="image/png"&&u.type!=="image/jpeg"){$.tips("Can not support file type!"),i.val("").trigger("change");return}if(u.size/1024/1024>5){$.tips($.i18n("i18n.upload.limit")),i.val("").trigger("change"),console.log(u.size);return}S=new Image,S.onload=function(){w=y=h*S.width,E=b=h*S.height,S.type=u.type,n.hide(),i.hide(),r.show(),s.show(),t.css({backgroundImage:"url({0})".tpl(e),backgroundPosition:"0px 0px",backgroundSize:"{0}px {1}px".tpl(y,b),backgroundRepeat:"no-repeat"}),r.show(),a.show(),r.show(),o.data("upload","ready"),S.load=!0},S.src=orgSrc=e});var C=!1,k=0,L=0,A=0,O=0;t.on("mousewheel",function(e){var t=e.wheelDelta||e.detail;return!t&&e.originalEvent&&(e=e.originalEvent,t=e.wheelDelta||e.detail),t==-120||t==3?x():(t==120||t==-3)&&T(),!1}).on("mouseenter",function(e){o.data("upload")=="ready"&&(u.show(),f.show(),a.show()),k=t.offset().left,L=t.offset().left+t.width(),A=t.offset().top,O=t.offset().top+t.height()}).on("mousedown",function(e){t.parents(".J-tip-contain").removeClass("input-box-error");if(!S){console.log("return");return}m=t.css("background-position-x").toFloat(),g=t.css("background-position-y").toFloat(),t.css("cursor","move"),d=e.pageX,v=e.pageY,p=!0,$.disableSelection(),console.log("down",p,d,v,m,g)}).on("mousemove",function(e){if(p){var n=e.pageX-d+m,r=e.pageY-v+g;console.log("move",n,l-y),n=Math.max(n,l-y),n=Math.min(n,0),r=Math.max(r,l-b),r=Math.min(r,0),console.log(n,r),t.css("background-position",n+"px "+r+"px")}}).on("mouseleave",function(e){p&&(p=!1,t.css("cursor","inherit"),$.enableSelection());if(e.pageX<=k||e.pageX>=L||e.pageY<=A||e.pageY>=O)u.hide(),a.hide(),f.hide()}).on("mouseup",function(){p&&(p=!1,t.css("cursor","inherit"),$.enableSelection())}),e.find(".J-reduce").click(function(){return x(),!1}),e.find(".J-zoom").click(function(){return T(),!1}),e.find(".J-upload-submit").click(function(){if(o.data("upload")=="ready"){var e;window.PAGE.DEBUG?e="http://lscdn.livestar.com/res/pc/public/data/preview.json":e="/api/?ct=api&ac=web&platform=livestar&method={0}".tpl("preview");var t=N();t||$.tips($.i18n("i18n.upload.no.image")),LS.ajaxBtn($(this),{url:e,data:{fileData:t,fileType:S.type},success:function(e){o.data("upload","uploaded");if(!e.url){$.tips($.i18n("i18n.upload.fail"));return}o.val(e.url).trigger("change")}})}})})})()})();</script>